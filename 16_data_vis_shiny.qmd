# Data Visualization {#sec-shiny_data_visualization_shiny}

This chaper details on how to utilize comprehensive visualization functions to explore and present your pathway enrichment and functional module results. Four main visualization approaches are covered: pathway bar charts, module information plots, similarity networks, and relationship networks.

::: callout-important
Prerequisites: Before creating visualizations, make sure you have completed the previous analysis steps. The visualization functions require objects from:

-   Enrichment analysis: [Chapter 12](12_enrichment_analysis_shiny.qmd)
-   Module clustering: [Chapter 13](13_pathway_similarity_shiny.qmd) and [Chapter 14](14_get_functional_modules_shiny.qmd)
-   Optional: LLM interpretation: [Chapter 15](15_llm_interpretation_shiny.qmd)
:::

## Overview of Visualization Functions

mapa provides four main visualization functions:

+---------------------------+--------------------------------------------------------+-----------------------------------------------------+
| Function tab              | Purpose                                                | Best Used For                                       |
+===========================+========================================================+=====================================================+
| Barplot                   | Horizontal bar charts of top enriched items            | Showing enrichment strength across pathways/modules |
+---------------------------+--------------------------------------------------------+-----------------------------------------------------+
| Module Information        | Multi-panel module details (network + bar + wordcloud) | Detailed examination of specific modules            |
+---------------------------+--------------------------------------------------------+-----------------------------------------------------+
| Module Similarity Network | Similarity-based networks                              | Understanding pathway relationships and clustering  |
+---------------------------+--------------------------------------------------------+-----------------------------------------------------+
| Relationship Network      | Multi-level hierarchical networks                      | Visualizing connections across biological levels    |
+---------------------------+--------------------------------------------------------+-----------------------------------------------------+

## Option 1: Pathway Bar Chart

This function creates horizontal bar charts showing the top enriched pathways, modules, or functional modules. This is ideal for presenting enrichment results in publications.

### Key Settings

+--------------+--------------------------------------+------------------------------------------------+
| Settings     | Description                          | Options/Default                                |
+==============+======================================+================================================+
| Level        | Analysis level                       | `Pathway`, `Module`, `FM`                      |
+--------------+--------------------------------------+------------------------------------------------+
| X axis name  | X-axis metric                        | ORA: `qscore`, `RichFactor`, `FoldEnrichment`; |
|              |                                      |                                                |
|              |                                      | GSEA: `NES`                                    |
+--------------+--------------------------------------+------------------------------------------------+
| Line type    | Bar style                            | `Straight` (default), `Meteor`                 |
+--------------+--------------------------------------+------------------------------------------------+
| LLM text     | Use LLM names for functional modules | Tick box                                       |
+--------------+--------------------------------------+------------------------------------------------+
| Top N        | Number of items to show              | Default: 10                                    |
+--------------+--------------------------------------+------------------------------------------------+
| Database     | Databases to include                 | `GO`, `KEGG`, `Reactome`                       |
+--------------+--------------------------------------+------------------------------------------------+
| Type         | In what form the image is ploted     | `pdf`, `jpg`, `jpeg`                           |
+--------------+--------------------------------------+------------------------------------------------+

Besides, you can tweak the color designated for each database by setting HEXA code or PGBA code or just manually set them.

![](images/shinyapp_16_choosecolor.png){fig-align="center" width="480"}

::: callout-note
**X-axis Metrics Explained**:

-   **qscore**: -log₁₀(adjusted p-value), higher values indicate more significant enrichment
-   **RichFactor**: Ratio of input genes in pathway vs. all genes in pathway
-   **FoldEnrichment**: Enrichment fold change (GeneRatio divided by BgRatio), see @sec-enrichment_res_interpretation
-   **NES**: Normalized Enrichment Score (GSEA only), positive/negative indicates up/down-regulation
:::

### Basic Usage

After setting all the parameters listed above, hit the Submit, and the plot will be shown on the right.

![](images/ora_pathway_level_barplot.png){fig-align="center" width="580"}

## Option 2: Module Information Plot

This function provides detailed, multi-panel visualizations of individual modules, including network topology, pathway rankings, and word clouds.

The content of each plot depends on the analysis level:

+----------------+----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| Plot level     | Module Level                                                                                 | FM Level                                                                                                                                         |
|                |                                                                                              |                                                                                                                                                  |
|                | *(Database-specific)*                                                                        | *(Cross-database)*                                                                                                                               |
+================+==============================================================================================+==================================================================================================================================================+
| **Network**    | Shows pathways within the database-specific module and their similarity connections          | Shows representative pathways from database-specific modules (SimCluster) or individual pathways (EmbedCluster)                                  |
+----------------+----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| **Bar plot**   | Ranks individual pathways within the module by significance                                  | Ranks the representative pathways or database-specific modules by significance                                                                   |
+----------------+----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+
| **Word cloud** | Word frequency from pathway descriptions, with word size reflecting statistical significance | Word frequency from all pathway descriptions in the functional module, with word size proportional to the sum of statistical significance values |
+----------------+----------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------+

::: callout-note
**Word Cloud Interpretation**: Word size reflects the cumulative statistical significance of pathways containing that word:

-   For ORA (Over-Representation Analysis): Word size is proportional to the sum of -log~10~(adjusted p-value) across pathways containing that word. Larger words indicate terms appearing in pathways with stronger statistical enrichment.
-   For GSEA (Gene Set Enrichment Analysis): Word size is proportional to the sum of \|NES\| (absolute Normalized Enrichment Score) across pathways containing that word. Larger words indicate terms appearing in pathways with stronger enrichment signals, regardless of direction (up- or down-regulation).
:::

## Option 3: Similarity Network

This function visualizes how pathways or modules cluster together based on similarity metrics.

## Option 4: Relationship Network

This function creates comprehensive multi-level networks showing relationships between functional modules, modules, pathways, and molecules.

## Next Steps

Continue to [Results Report](17_res_report_shiny.qmd) to learn how to generate comprehensive analysis reports that combine all your results into professional documents.
